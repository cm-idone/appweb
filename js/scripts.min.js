"use strict";$(window).on("beforeunload ajaxStart",function(){$("body").prepend('<div data-ajax-loader><div class="loader"></div></div>')});$(window).on("ajaxStop",function(){$("body").find("[data-ajax-loader]").remove()});$(document).ready(function(){$('[data-action="open_rightbar"]').on("click",function(a){a.stopPropagation();$("header.rightbar").toggleClass("open");$("body").toggleClass("open")});$('[data-action="switch_account"]').on("click",function(){$.ajax({url:"/system",type:"POST",data:"action=switch_account&id="+$(this).data("id"),processData:false,cache:false,dataType:"json",success:function(a){if(a.status=="success"){location.reload()}else{if(a.status=="error"){open_notification_modal("alert",a.message)}}}})});$('[data-action="logout"]').on("click",function(){$.ajax({url:"/system",type:"POST",data:"action=logout",processData:false,cache:false,dataType:"json",success:function(a){window.location.href=a.path}})});$('[data-action="go_back"]').on("click",function(){window.history.back()});$("[data-low-uploader]").each(function(){uploader("low",$(this))});$("[data-fast-uploader]").each(function(){uploader("fast",$(this))});$("[data-image-src]").each(function(){$(this).css("background-image",'url("'+$(this).data("image-src")+'")')});$(".checkbox.st-1").find('input[type="checkbox"]').on("change",function(){$(this).parents("fieldset").find("[data-search]").val("");$(this).parents("fieldset").find("[data-search]").focus()});$(".checkbox.st-4").find('input[type="checkbox"]').on("change",function(){$(this).parents("fieldset").find("[data-search]").val("");var b=$(this);var a=b.parents("[data-table]").find("[data-target]");$.each(a,function(f,h){var e=b.val()+"[]";var g=h.getElementsByTagName("input")[0];var d=h.getElementsByTagName("input")[1];var c=h.getElementsByTagName("select")[0];var i=h.getAttribute("data-target");if(d.getAttribute("name")==e){d.value="";c.value="";if(g.checked==true){d.focus()}else{b.parents("fieldset").find("[data-search]").focus()}}else{if(i=="required"){if(d.value==""||d.value<="0"||c.value==""){g.checked=false;d.value="";c.value=""}}}})});$(".checkbox.st-4").find('input[type="text"]').on("keyup",function(){validate_string("float",$(this).val(),$(this));if($(this).val().length>0){$(this).parent().find('input[type="checkbox"]').prop("checked",true)}else{$(this).parent().find('input[type="checkbox"]').prop("checked",false);$(this).parent().find("select").val("")}});$(".checkbox.st-4").find("select").on("change",function(){$(this).parent().find('input[type="checkbox"]').prop("checked",true);if($(this).parent().find('input[type="text"]').val()<="0"){$(this).parent().find('input[type="text"]').val("")}$(this).parent().find('input[type="text"]').focus()});$(".compound.st-5-double").find('input[type="radio"]').on("click",function(){$(this).parents(".compound.st-5-double").find("span").removeClass("checked");$(this).parents("label").find("span").addClass("checked")});$(".compound.st-5-triple").find('input[type="radio"]').on("click",function(){$(this).parents(".compound.st-5-triple").find("span").removeClass("checked");$(this).parents("label").find("span").addClass("checked")});$(".compound.st-6").find("[data-search] > input").on("keyup",function(){search_in_table($(this).val(),$(this).parents(".compound.st-6").find("[data-list]"),"hidden")});$(".compound.st-6").find("[data-list] > [data-success]").on("click",function(){$(this).parents(".compound.st-6").find("[data-preview] > input").val($(this).data("value"));$(this).parents(".compound.st-6").find("[data-preview] > div").html($(this).parent().find("div").html());$(this).parents(".compound.st-6").find("[data-preview]").addClass("open");$(this).parents(".compound.st-6").find("[data-search] > input").val("");$(this).parents(".compound.st-6").find("[data-search]").addClass("close");$(this).parents(".compound.st-6").find("[data-list]").addClass("hidden")});$(".compound.st-6").find("[data-preview] > [data-cancel]").on("click",function(){$(this).parents(".compound.st-6").find("[data-preview] > input").val("");$(this).parents(".compound.st-6").find("[data-preview] > div").html("");$(this).parents(".compound.st-6").find("[data-preview]").removeClass("open");$(this).parents(".compound.st-6").find("[data-search] > input").val("");$(this).parents(".compound.st-6").find("[data-search]").removeClass("close");$(this).parents(".compound.st-6").find("[data-list]").addClass("hidden");$(this).parents(".compound.st-6").find("[data-search] > input").focus()});window.onresize=resize_canvas});function search_in_table(b,c,a){a=(a==undefined)?"normal":"hidden";$.each(c,function(h,i){var f=i.getElementsByTagName("input");if(b.length>0){var g=b.toLowerCase();var e=i.innerHTML.toLowerCase();var d=e.indexOf(g);if(d>0){i.className=""}else{if(d<=0){i.className=(a=="hidden")?((f.length==0)?"hidden":((f.length>0&&f[0].checked==false)?"hidden":"")):"hidden"}}}else{if(b.length<=0&&a=="normal"){i.className=""}else{if(b.length<=0&&a=="hidden"){i.className=(f.length==0)?"hidden":((f.length>0&&f[0].checked==false)?"hidden":"")}}}})}function validate_string(h,g,j){if(h=="empty"){return(g==undefined||g==null||g=="")?true:false}else{if(h=="uppercase"||h=="lowercase"||h=="int"||h=="float"){var b="";var d="ABCDEFGHIJKLMNÑOPQRSTUVWXYZ";var c="abcdefghijklmnñopqrstuvwxyz";var k="0123456789";var a=".";if(Array.isArray(h)){$.each(h,function(i,l){if(l=="uppercase"){b=b+d}else{if(l=="lowercase"){b=b+c}else{if(l=="int"){b=b+k}else{if(l=="float"){b=b+a+k}}}}})}else{if(h=="uppercase"){b=d}else{if(h=="lowercase"){b=c}else{if(h=="int"){b=k}else{if(h=="float"){b=a+k}}}}}var e="";for(var f=0;f<g.length;f++){if(b.indexOf(g.charAt(f))!=-1){e+=g.charAt(f)}}j.val(e)}}}function generate_string(g,c,h){var b="";var e="ABCDEFGHIJKLMNÑOPQRSTUVWXYZ";var d="abcdefghijklmnñopqrstuvwxyz";var k="0123456789";var a=".";if(Array.isArray(g)){$.each(g,function(l,m){if(m=="uppercase"){b=b+e}else{if(m=="lowercase"){b=b+d}else{if(m=="int"){b=b+k}else{if(m=="float"){b=b+a+k}}}}})}else{if(g=="uppercase"){b=e}else{if(g=="lowercase"){b=d}else{if(g=="int"){b=k}else{if(g=="float"){b=a+k}}}}}var f="";for(var j=0;j<c;j++){var i=Math.floor(Math.random()*b.length);f+=b.substr(i,1)}h.val(f)}var action=null;var id=null;function open_form_modal(a,b,c){if(a=="create"||a=="read"||a=="update"||a=="filter"){if(a=="create"||a=="update"){reset_form(b.find("form"))}if(a=="read"||a=="update"){$.ajax({type:"POST",data:"action="+action+"&id="+id,processData:false,cache:false,dataType:"json",success:function(d){if(d.status=="success"){c(d.data)}else{if(d.status=="error"){open_notification_modal("alert",d.message)}}}})}}b.addClass("view")}function send_form_modal(a,d,b){if(a=="create"||a=="update"||a=="filter"){b.preventDefault();var c=new FormData(d[0]);c.append("action",action);c.append("id",id);$.ajax({type:"POST",data:c,contentType:false,processData:false,cache:false,dataType:"json",success:function(e){check_form_errors(d,e,function(){open_notification_modal("success",e.message)})}})}else{if(a=="block"||a=="unblock"){$.ajax({type:"POST",data:"action="+action+"&id="+id,processData:false,cache:false,dataType:"json",success:function(e){if(e.status=="success"){location.reload()}else{if(e.status=="error"){open_notification_modal("alert",e.message)}}}})}else{if(a=="delete"){$.ajax({type:"POST",data:"action="+action+"&id="+id,processData:false,cache:false,dataType:"json",success:function(e){if(e.status=="success"){open_notification_modal("success",e.message)}else{if(e.status=="error"){open_notification_modal("alert",e.message)}}}})}}}}function transform_form_modal(a,b){if(a=="create"){b.find("form").find('button[type="submit"]').html('<i class="fas fa-plus"></i>');b.find("form").find('button[type="submit"]').removeClass("warning");b.find("form").find('button[type="submit"]').addClass("success")}else{if(a=="update"){b.find("form").find('button[type="submit"]').html('<i class="fas fa-pen"></i>');b.find("form").find('button[type="submit"]').removeClass("success");b.find("form").find('button[type="submit"]').addClass("warning")}}}function reset_form(a){a[0].reset();a.find(".uploader").find("img").attr("src","../images/empty.png");a.find("p.error").remove();a.find(".error").removeClass("error")}function open_notification_modal(a,b,d,c){b=(b==undefined)?"":b;d=(d==undefined)?((a=="success")?"reload":false):d;c=(c==undefined)?"500":c;if(a=="success"){$('[data-modal="success"]').addClass("view");$('[data-modal="success"]').find("main > p").html(b)}else{if(a=="alert"){$('[data-modal="alert"]').addClass("view");$('[data-modal="alert"]').find("main > p").html(b)}}if(d!=false){setTimeout(function(){if(d=="reload"){location.reload()}else{window.location.href=d}},c)}}function check_form_errors(b,a,c){b.find("[name]").parents(".error").find("p.error").remove();b.find("[name]").parents(".error").removeClass("error");if(a.status=="success"){c()}else{if(a.status=="error"){if(Array.isArray(a.errors)){$.each(a.errors,function(d,e){b.find('[name="'+e[0]+'"]').parent().addClass("error");b.find('[name="'+e[0]+'"]').parent().append('<p class="error">'+e[1]+"</p>")});b.find('input[name="'+a.errors[0][0]+'"]').focus()}else{open_notification_modal("alert",a.message)}}}}function uploader(a,b){b.find("a[data-select]").on("click",function(){b.find("input[data-select]").click()});b.find("input[data-select]").on("change",function(){var e=false;var d=$(this).attr("accept").split(",");var f=$(this)[0].files[0];$.each(d,function(h,i){if(f.type.match(i)){e=true}});if(e==true){if(a=="low"){var c=new FileReader();c.onload=function(h){var i=h.target.result.split(";");i=i[0].split("/");if(i[1]=="pdf"){b.find("[data-preview] > img").attr("src","/../images/pdf.png")}else{b.find("[data-preview] > img").attr("src",h.target.result)}};c.readAsDataURL(f)}else{if(a=="fast"){var g=new FormData();g.append("action",action);g.append("file",f);$.ajax({type:"POST",data:g,contentType:false,processData:false,cache:false,dataType:"json",success:function(h){if(h.status=="success"){open_notification_modal("success",h.message,true)}else{if(h.status=="error"){open_notification_modal("alert",h.message)}}}})}}}else{open_notification_modal("alert","ERROR")}})}function nav_scroll_down(f,d,a,e,c,b){var g={initialize:function(){$(document).each(function(){g.scroller()});$(document).on("scroll",function(){g.scroller()})},scroller:function(){if($(document).scrollTop()>a){if(e||b){$(e).attr("src",b)}$(f).addClass(d)}else{if(e||c){$(e).attr("src",c)}$(f).removeClass(d)}}};g.initialize()}function resize_canvas(b){var a=Math.max(window.devicePixelRatio||1,1);b.width=b.offsetWidth*a;b.height=b.offsetHeight*a;b.getContext("2d").scale(a,a)};